import{j as n}from"./jsx-runtime-ffb262ed.js";import{r as a}from"./index-76fb7be0.js";import{T as S}from"./TIcon-d773ec1e.js";import{u as O}from"./UseValidator-1d683c89.js";import{u as A}from"./UseClickOutside-961b265f.js";import{T as H}from"./TCheckbox-b59f37d6.js";import{T as L}from"./TTextField-489517b1.js";import{T as p}from"./THighlightText-0de6d4e4.js";import{T as G}from"./TChip-b8a4a41e.js";const _=a.forwardRef((e,x)=>{var k;const u=O(e.value,e.rules,e.successMessage),T=a.useRef(null),c=a.useRef(null),h=a.useRef(null),[d,v]=a.useState(""),[s,w]=a.useState(!1),[m,D]=a.useState(new Map);a.useImperativeHandle(x,()=>({focus(){var l;(l=c==null?void 0:c.current)==null||l.focus()},validate(){return u.validate()}}));const r=a.useCallback(()=>{c.current.focus()},[]),f=a.useCallback(l=>{e.onChange(l),e.multiple?e.value.includes(l)?e.onChange(e.value.filter(t=>t!==l)):e.onChange([...e.value,l]):e.onChange(l)},[e]),V=a.useCallback(()=>{const l=new Map;e.items.forEach(t=>{l.set(t[e.valueKey],t)}),D(l)},[e.items,e.valueKey]),i=a.useCallback(()=>{w(!1),v(""),r()},[r]),g=a.useCallback(()=>{w(!0),u.clearValidation()},[u]),y=a.useCallback(()=>{s?i():g()},[i,s,g]),o=a.useCallback(l=>l?e.itemTemplate?e.itemTemplate(l):l[e.textKey]:"",[e]),C=a.useCallback(()=>!e.multiple&&d===o(m.get(e.value))?e.items:e.items.filter(l=>o(l).toLowerCase().includes(d==null?void 0:d.toLowerCase())),[d,o,m,e.items,e.multiple,e.value]),K=a.useMemo(()=>{const l=[];return e.className&&l.push(e.className),s&&l.push("t-dropdown--open"),e.disabled&&l.push("t-dropdown--disabled"),u.result||l.push("t-dropdown--failure"),u.result&&u.message&&l.push("t-dropdown--success"),l.push(`t-dropdown--${e.type}`),l.join(" ")},[s,e.className,e.disabled,e.type,u.message,u.result]),j=a.useMemo(()=>{var t;const l=[];return((t=e.value)==null?void 0:t.length)===0&&l.push("t-dropdown__control__selected--empty"),l.join(" ")},[(k=e.value)==null?void 0:k.length]),N=a.useMemo(()=>{const l=[];return s&&l.push("t-dropdown__items--open"),e.noDetail&&l.push("t-dropdown__items--no-detail"),C().length===0&&l.push("t-dropdown__items--empty"),l.join(" ")},[C,s,e.noDetail]),q=a.useCallback(l=>{const t=[];return(typeof e.value=="object"&&e.value.includes(l[e.valueKey])||typeof e.value=="string"&&e.value===l[e.valueKey])&&t.push("t-dropdown__items__item--selected"),t.join(" ")},[e.value,e.valueKey]),z=a.useMemo(()=>{let l={};return e.style&&(l={...e.style}),e.width&&(l={...l,width:e.width}),l},[e.style,e.width]),M=a.useCallback(()=>{y(),r()},[r,y]),b=a.useCallback(l=>{f(l),e.multiple||i()},[i,f,e.multiple]),I=a.useCallback(()=>{!s&&!e.lazy&&u.validate()},[s,e.lazy,u]),E=a.useCallback(l=>{v(l)},[]),F=a.useCallback(l=>{l.key==="Escape"&&i()},[i]),R=a.useCallback(l=>{l.key==="Escape"&&i(),(l.key==="Enter"||l.key===" ")&&y()},[i,y]),$=a.useCallback((l,t)=>{l.key==="Escape"&&i(),l.key==="Enter"&&(f(t),e.multiple||(r(),i()))},[i,r,f,e.multiple]),B=a.useCallback(()=>{e.multiple||e.onChange("")},[e]),P=a.useMemo(()=>{var l;return((l=e.value)==null?void 0:l.length)===0?e.placeholder:null},[e.value,e.placeholder]);return A(h,i),a.useEffect(()=>{V()},[e.items,e.valueKey]),n.jsxs("div",{ref:h,className:`t-dropdown ${K}`,style:z,onBlur:I,id:e.id,"data-testid":"dropdown-root",children:[n.jsxs("div",{className:"t-dropdown__control",tabIndex:e.disabled?-1:0,onKeyDown:R,ref:c,onClick:M,children:[n.jsxs("div",{className:`t-dropdown__control__selected ${j}`,children:[P,e.multiple&&e.chip&&e.value.map(l=>n.jsx(G,{small:!0,onRemove:e.disabled?null:()=>b(l),children:o(m.get(l))},l)),e.multiple&&!e.chip&&e.value.map(l=>o(m.get(l))).join(", "),!e.multiple&&o(m.get(e.value))]}),n.jsx(S,{className:`t-dropdown__control__opener ${s?"t-dropdown__control__opener--open":""}`,small:!0,clickable:!0,color:e.disabled?"#CCCCCC":"#000000",children:"keyboard_arrow_down"})]}),n.jsxs("div",{className:`t-dropdown__items ${N}`,children:[n.jsx(L,{ref:T,className:"t-dropdown__items__filter-text",value:d,placeholder:e.filterPlaceholder,disabled:e.disabled,noTrim:!0,searchable:!0,onChange:E,onClear:B,onKeyDown:F}),n.jsxs("div",{className:"t-dropdown__items__wrapper",children:[s&&C().map(l=>n.jsxs("div",{className:`t-dropdown__items__item ${q(l)}`,tabIndex:e.multiple?-1:0,onClickCapture:()=>b(l[e.valueKey]),onKeyDown:t=>$(t,l[e.valueKey]),children:[e.multiple&&n.jsx(H,{className:"t-dropdown__items__item__checkbox",checked:e.value.includes(l[e.valueKey])}),n.jsx(p,{keyword:d,children:o(l)})]},l[e.valueKey])),s&&C().length===0&&n.jsx("div",{className:"t-dropdown__items__item",children:"검색 결과가 없습니다."})]})]}),!e.noDetail&&n.jsx("div",{className:"t-dropdown__details",children:n.jsx("div",{className:"t-dropdown__details__message",children:u.message&&`${u.message}`})})]})});_.defaultProps={type:"outline",valueKey:"value",textKey:"text",placeholder:"목록에서 선택해 주세요",filterPlaceholder:"검색어를 입력해 주세요",chip:!0,lazy:!0};_.displayName="TDropdown";try{_.displayName="TDropdown",_.__docgenInfo={description:"",displayName:"TDropdown",props:{itemsClassName:{defaultValue:null,description:"",name:"itemsClassName",required:!1,type:{name:"string"}},type:{defaultValue:{value:"outline"},description:"",name:"type",required:!1,type:{name:"enum",value:[{value:'"outline"'},{value:'"underline"'}]}},width:{defaultValue:null,description:"",name:"width",required:!1,type:{name:"string"}},items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"TDropdownItem[]"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"TDropdownValue"}},multiple:{defaultValue:null,description:"",name:"multiple",required:!1,type:{name:"boolean"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},noDetail:{defaultValue:null,description:"",name:"noDetail",required:!1,type:{name:"boolean"}},placeholder:{defaultValue:{value:"목록에서 선택해 주세요"},description:"",name:"placeholder",required:!1,type:{name:"string"}},filterPlaceholder:{defaultValue:{value:"검색어를 입력해 주세요"},description:"",name:"filterPlaceholder",required:!1,type:{name:"string"}},textKey:{defaultValue:{value:"text"},description:"",name:"textKey",required:!1,type:{name:"string"}},valueKey:{defaultValue:{value:"value"},description:"",name:"valueKey",required:!1,type:{name:"string"}},itemTemplate:{defaultValue:null,description:"",name:"itemTemplate",required:!1,type:{name:"(item: TDropdownItem) => string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: string | string[]) => void"}},chip:{defaultValue:{value:"true"},description:"",name:"chip",required:!1,type:{name:"boolean"}},lazy:{defaultValue:{value:"true"},description:"",name:"lazy",required:!1,type:{name:"boolean"}},rules:{defaultValue:null,description:"",name:"rules",required:!1,type:{name:"((value: any) => string | true)[]"}},successMessage:{defaultValue:null,description:"",name:"successMessage",required:!1,type:{name:"string"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}},id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}}}}}catch{}export{_ as T};
//# sourceMappingURL=TDropdown-76c0e570.js.map
