import{j as n}from"./jsx-runtime-CKrituN3.js";import{r as a}from"./index-CBqU2yxZ.js";import{u as L}from"./UseValidator-XS2alT9g.js";import{u as A}from"./UseClickOutside-Bbiir3uY.js";import{T as J}from"./TCheckbox-e-mXbj8-.js";import{T as Q}from"./TTextField-CEWTsgSK.js";import{T as U}from"./THighlightText-ySiKuYph.js";import{T as V}from"./TIcon-DX3nHo9a.js";import{T as W}from"./TChip-E-ijVkLD.js";import{t as C}from"./ThemeToken.module-BX06fUfM.js";const h=a.forwardRef((e,q)=>{var T;const i=L(e.value,e.rules,e.successMessage),j=a.useRef(null),c=a.useRef(null),v=a.useRef(null),[s,w]=a.useState(""),[d,g]=a.useState(!1),[m,K]=a.useState(new Map);a.useImperativeHandle(q,()=>({focus(){var l;(l=c==null?void 0:c.current)==null||l.focus()},validate(){return i.validate()}}));const r=a.useCallback(()=>{c.current.focus()},[]),f=a.useCallback(l=>{e.multiple?e.value.includes(l)?e.onChange(e.value.filter(t=>t!==l)):e.onChange([...e.value,l]):e.onChange(l)},[e]),b=a.useCallback(()=>{e.onChange("")},[e]),N=a.useCallback(()=>{const l=new Map;e.items.forEach(t=>{l.set(t[e.valueKey],t)}),K(l)},[e.items,e.valueKey]),u=a.useCallback(l=>{var t;g(!1),(t=e.onClose)==null||t.call(e),w(""),l&&r()},[r,e]),k=a.useCallback(()=>{var l;g(!0),(l=e.onOpen)==null||l.call(e),i.clearValidation()},[e,i]),y=a.useCallback(()=>{d?u(!0):k()},[u,d,k]),o=a.useCallback(l=>l?e.itemTemplate?e.itemTemplate(l):l[e.textKey]:"",[e]),_=a.useCallback(()=>!e.multiple&&s===o(m.get(e.value))?e.items:e.items.filter(l=>o(l).toLowerCase().includes(s==null?void 0:s.toLowerCase())),[s,o,m,e.items,e.multiple,e.value]),D=a.useMemo(()=>{const l=[];return e.className&&l.push(e.className),d&&l.push("t-dropdown--open"),e.disabled&&l.push("t-dropdown--disabled"),e.dense&&l.push("t-dropdown--dense"),i.result||l.push("t-dropdown--failure"),i.result&&i.message&&l.push("t-dropdown--success"),l.push(`t-dropdown--${e.type}`),l.join(" ")},[d,e.className,e.disabled,e.type,i.message,i.result]),z=a.useMemo(()=>{var t;const l=[];return((t=e.value)==null?void 0:t.length)===0&&l.push("t-dropdown__control__selected--empty"),l.join(" ")},[(T=e.value)==null?void 0:T.length]),M=a.useMemo(()=>{const l=[];return d&&l.push("t-dropdown__items--open"),e.noDetail&&l.push("t-dropdown__items--no-detail"),_().length===0&&l.push("t-dropdown__items--empty"),l.join(" ")},[_,d,e.noDetail]),I=a.useCallback(l=>{const t=[];return(typeof e.value=="object"&&e.value.includes(l[e.valueKey])||typeof e.value=="string"&&e.value===l[e.valueKey])&&t.push("t-dropdown__items__item--selected"),t.join(" ")},[e.value,e.valueKey]),E=a.useMemo(()=>{let l={};return e.style&&(l={...e.style}),e.width&&(l={...l,width:e.width}),l},[e.style,e.width]),O=a.useCallback(()=>{y(),r()},[r,y]),P=a.useCallback(l=>{l.stopPropagation(),b()},[b]),x=a.useCallback(l=>{f(l),e.multiple||u(!0)},[u,f,e.multiple]),R=a.useCallback(()=>{!d&&!e.lazy&&i.validate()},[d,e.lazy,i]),$=a.useCallback(l=>{w(l)},[]),F=a.useCallback(l=>{l.key==="Escape"&&u(!0)},[u]),S=a.useCallback(l=>{l.key==="Escape"&&u(!0),(l.key==="Enter"||l.key===" ")&&y()},[u,y]),B=a.useCallback((l,t)=>{l.key==="Escape"&&u(!0),l.key==="Enter"&&(f(t),e.multiple||(r(),u(!0)))},[u,r,f,e.multiple]),G=a.useCallback(()=>{e.multiple||e.onChange("")},[e]),H=a.useMemo(()=>{var l;return((l=e.value)==null?void 0:l.length)===0?e.placeholder:null},[e.value,e.placeholder]);return A(v,()=>u(!1)),a.useEffect(()=>{N()},[e.items,e.valueKey]),n.jsxs("div",{ref:v,className:`t-dropdown ${D}`,style:E,onBlur:R,id:e.id,"data-testid":"dropdown-root",children:[n.jsxs("div",{className:"t-dropdown__control",tabIndex:e.disabled?-1:0,onKeyDown:S,ref:c,onClick:O,"data-testid":"dropdown-control",children:[n.jsxs("div",{className:`t-dropdown__control__selected ${z}`,children:[H,e.multiple&&e.chip&&e.value.map(l=>n.jsx(W,{onRemove:e.disabled?null:()=>x(l),children:o(m.get(l))},l)),e.multiple&&!e.chip&&e.value.map(l=>o(m.get(l))).join(", "),!e.multiple&&o(m.get(e.value))]}),!e.multiple&&e.value&&!e.noClearButton&&n.jsx(V,{className:"t-dropdown__control__remover",small:!0,fill:!0,color:C.tGrayColor3,onClick:P,children:"cancel"}),n.jsx(V,{className:`t-dropdown__control__opener ${d?"t-dropdown__control__opener--open":""}`,color:e.disabled?C.tGrayColor4:C.tGrayColor6,children:"arrow_drop_down"})]}),n.jsxs("div",{className:`t-dropdown__items ${M}`,children:[n.jsx(Q,{ref:j,className:"t-dropdown__items__filter-text",value:s,placeholder:e.filterPlaceholder,disabled:e.disabled,noTrim:!0,searchable:!0,dense:e.dense,onChange:$,onClear:G,onKeyDown:F}),n.jsxs("div",{className:"t-dropdown__items__wrapper",children:[d&&_().map(l=>n.jsxs("div",{className:`t-dropdown__items__item ${I(l)}`,tabIndex:e.multiple?-1:0,onClickCapture:()=>x(l[e.valueKey]),onKeyDown:t=>B(t,l[e.valueKey]),children:[e.multiple&&n.jsx(J,{className:"t-dropdown__items__item__checkbox",checked:e.value.includes(l[e.valueKey])}),n.jsx(U,{keyword:s,children:o(l)})]},l[e.valueKey])),d&&_().length===0&&n.jsx("div",{className:"t-dropdown__items__item t-dropdown__items__item--no-result",children:"검색 결과가 없습니다."})]})]}),!e.noDetail&&n.jsx("div",{className:"t-dropdown__details",children:n.jsx("div",{className:"t-dropdown__details__message",children:i.message&&`${i.message}`})})]})});h.defaultProps={type:"outline",valueKey:"value",textKey:"text",placeholder:"선택",filterPlaceholder:"검색",chip:!0,lazy:!0,noClearButton:!1};h.displayName="TDropdown";try{h.displayName="TDropdown",h.__docgenInfo={description:"",displayName:"TDropdown",props:{itemsClassName:{defaultValue:null,description:"",name:"itemsClassName",required:!1,type:{name:"string"}},type:{defaultValue:{value:"outline"},description:"",name:"type",required:!1,type:{name:"enum",value:[{value:'"outline"'},{value:'"underline"'}]}},width:{defaultValue:null,description:"",name:"width",required:!1,type:{name:"string"}},items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"TDropdownItem[]"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"TDropdownValue"}},multiple:{defaultValue:null,description:"",name:"multiple",required:!1,type:{name:"boolean"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},noClearButton:{defaultValue:{value:"false"},description:"",name:"noClearButton",required:!1,type:{name:"boolean"}},noDetail:{defaultValue:null,description:"",name:"noDetail",required:!1,type:{name:"boolean"}},chip:{defaultValue:{value:"true"},description:"",name:"chip",required:!1,type:{name:"boolean"}},dense:{defaultValue:null,description:"",name:"dense",required:!1,type:{name:"boolean"}},placeholder:{defaultValue:{value:"선택"},description:"",name:"placeholder",required:!1,type:{name:"string"}},filterPlaceholder:{defaultValue:{value:"검색"},description:"",name:"filterPlaceholder",required:!1,type:{name:"string"}},textKey:{defaultValue:{value:"text"},description:"",name:"textKey",required:!1,type:{name:"string"}},valueKey:{defaultValue:{value:"value"},description:"",name:"valueKey",required:!1,type:{name:"string"}},itemTemplate:{defaultValue:null,description:"",name:"itemTemplate",required:!1,type:{name:"(item: TDropdownItem) => string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: string | string[]) => void"}},onOpen:{defaultValue:null,description:"",name:"onOpen",required:!1,type:{name:"() => void"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!1,type:{name:"() => void"}},lazy:{defaultValue:{value:"true"},description:"",name:"lazy",required:!1,type:{name:"boolean"}},rules:{defaultValue:null,description:"",name:"rules",required:!1,type:{name:"((value: any) => string | true)[]"}},successMessage:{defaultValue:null,description:"",name:"successMessage",required:!1,type:{name:"string"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}},id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}}}}}catch{}export{h as T};
