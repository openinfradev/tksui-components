import{j as l}from"./jsx-runtime-ffb262ed.js";import{r as a}from"./index-76fb7be0.js";import{T as H}from"./TIcon-88002bc5.js";import{u as P}from"./UseValidator-1d683c89.js";import{u as B}from"./UseClickOutside-961b265f.js";import{T as A}from"./TCheckbox-75efae35.js";import{T as G}from"./TTextField-7c9fada5.js";import{T as J}from"./THighlightText-0de6d4e4.js";import{T as Q}from"./TChip-4e6a6d45.js";const m=a.forwardRef((e,V)=>{var b;const i=P(e.value,e.rules,e.successMessage),c=a.useRef(null),v=a.useRef(null),[d,g]=a.useState(""),[u,w]=a.useState(!1),[r,j]=a.useState(new Map);a.useImperativeHandle(V,()=>({focus(){var t;(t=c==null?void 0:c.current)==null||t.focus()},validate(){return i.validate()}}));const s=a.useCallback(t=>t?e.itemTemplate?e.itemTemplate(t):t[e.textKey]:"",[e]),f=a.useCallback(()=>!e.multiple&&d===s(r.get(e.value))?e.items:e.items.filter(t=>s(t).toLowerCase().includes(d==null?void 0:d.toLowerCase())),[d,s,r,e.items,e.multiple,e.value]),K=a.useMemo(()=>{const t=[];return u&&t.push("t-dropdown--open"),e.disabled&&t.push("t-dropdown--disabled"),i.result||t.push("t-dropdown--failure"),i.result&&i.message&&t.push("t-dropdown--success"),t.push(`t-dropdown--${e.type}`),t.join(" ")},[u,e.disabled,e.type,i.message,i.result]),k=a.useMemo(()=>{var n;const t=[];return((n=e.value)==null?void 0:n.length)===0&&t.push("t-dropdown__control__selected--empty"),t.join(" ")},[(b=e.value)==null?void 0:b.length]),q=a.useMemo(()=>{const t=[];return u&&t.push("t-dropdown__items--open"),e.noDetail&&t.push("t-dropdown__items--no-detail"),f().length===0&&t.push("t-dropdown__items--empty"),t.join(" ")},[f,u,e.noDetail]),D=a.useCallback(t=>{const n=[];return(typeof e.value=="object"&&e.value.includes(t[e.valueKey])||typeof e.value=="string"&&e.value===t[e.valueKey])&&n.push("t-dropdown__items__item--selected"),n.join(" ")},[e.value,e.valueKey]),N=a.useMemo(()=>{let t={};return e.style&&(t={...e.style}),e.width&&(t={...t,width:e.width}),t},[e.style,e.width]),I=()=>{h(),y()},C=t=>{T(t),y(),e.multiple||o()},M=()=>{i.clearValidation()},p=()=>{!u&&!e.lazy&&(i.validate(),x())},z=t=>{g(t),t.length>0?h(!0):h(!1)},F=t=>{t.key==="Escape"&&o(),t.key==="Enter"&&_()},E=(t,n)=>{t.key==="Escape"&&o(),t.key==="Enter"&&(T(n),e.multiple||(y(),o()))},$=()=>{e.multiple||e.onChange("")},y=()=>{c.current.focus()},x=()=>{e.multiple||g(s(r.get(e.value)))},T=t=>{e.multiple?e.value.includes(t)?e.onChange(e.value.filter(n=>n!==t)):e.onChange([...e.value,t]):e.onChange(t)},R=()=>{const t=new Map;e.items.forEach(n=>{t.set(n[e.valueKey],n)}),j(t)},o=()=>{w(!1)},_=()=>{w(!0),i.clearValidation()},h=t=>{t===!0?_():t===!1||u?o():_()},S=a.useMemo(()=>{var t;return((t=e.value)==null?void 0:t.length)===0?e.placeholder:null},[e.value,e.placeholder]),L=()=>e.multiple?e.chip?l.jsx(l.Fragment,{children:e.value.map(t=>l.jsx(Q,{small:!0,onRemove:e.disabled?null:()=>C(t),children:s(r.get(t))},t))}):l.jsx(l.Fragment,{children:e.value.map(t=>s(r.get(t))).join(", ")}):l.jsx(l.Fragment,{}),O=t=>l.jsx(J,{keyword:d,children:s(t)});return B(v,o),a.useEffect(R,[e.items,e.valueKey]),a.useEffect(x,[s,r,e.multiple,e.value]),l.jsxs("div",{ref:v,className:`t-dropdown ${K}`,style:N,onFocus:M,onBlur:p,children:[l.jsxs("div",{className:"t-dropdown__control",onClick:I,children:[l.jsxs("div",{className:`t-dropdown__control__selected ${k}`,children:[L(),l.jsx(G,{ref:c,className:"t-dropdown__control__filter-text",value:d,clearable:!0,placeholder:S,disabled:e.disabled,noTrim:!0,onChange:z,onKeyDown:F,onClear:$})]}),l.jsx(H,{className:`t-dropdown__control__opener ${u?"t-dropdown__control__opener--open":""}`,small:!0,clickable:!0,color:e.disabled?"#CCCCCC":"#000000",children:"keyboard_arrow_down"})]}),l.jsx("div",{className:`t-dropdown__items ${q}`,children:u&&f().map(t=>l.jsxs("div",{className:`t-dropdown__items__item ${D(t)}`,tabIndex:e.multiple?-1:0,onClickCapture:()=>C(t[e.valueKey]),onKeyDown:n=>E(n,t[e.valueKey]),children:[e.multiple&&l.jsx(A,{className:"t-dropdown__items__item__checkbox",checked:e.value.includes(t[e.valueKey])}),O(t)]},t[e.valueKey]))}),!e.noDetail&&l.jsx("div",{className:"t-dropdown__details",children:l.jsx("div",{className:"t-dropdown__details__message",children:i.message&&`${i.message}`})})]})});m.defaultProps={type:"outline",valueKey:"value",textKey:"text",placeholder:"선택",chip:!0,lazy:!0};m.displayName="TDropdown";try{m.displayName="TDropdown",m.__docgenInfo={description:"",displayName:"TDropdown",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},itemsClassName:{defaultValue:null,description:"",name:"itemsClassName",required:!1,type:{name:"string"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"{ [key: string]: string; }"}},type:{defaultValue:{value:"outline"},description:"",name:"type",required:!1,type:{name:"enum",value:[{value:'"outline"'},{value:'"underline"'}]}},width:{defaultValue:null,description:"",name:"width",required:!1,type:{name:"string"}},items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"TDropdownItem[]"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"TDropdownValue"}},multiple:{defaultValue:null,description:"",name:"multiple",required:!1,type:{name:"boolean"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},noDetail:{defaultValue:null,description:"",name:"noDetail",required:!1,type:{name:"boolean"}},placeholder:{defaultValue:{value:"선택"},description:"",name:"placeholder",required:!1,type:{name:"string"}},textKey:{defaultValue:{value:"text"},description:"",name:"textKey",required:!1,type:{name:"string"}},valueKey:{defaultValue:{value:"value"},description:"",name:"valueKey",required:!1,type:{name:"string"}},itemTemplate:{defaultValue:null,description:"",name:"itemTemplate",required:!1,type:{name:"(item: TDropdownItem) => string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: string | string[]) => void"}},chip:{defaultValue:{value:"true"},description:"",name:"chip",required:!1,type:{name:"boolean"}},lazy:{defaultValue:{value:"true"},description:"",name:"lazy",required:!1,type:{name:"boolean"}},rules:{defaultValue:null,description:"",name:"rules",required:!1,type:{name:"((value: any) => string | true)[]"}},successMessage:{defaultValue:null,description:"",name:"successMessage",required:!1,type:{name:"string"}}}}}catch{}export{m as T};
//# sourceMappingURL=TDropdown-0c1f38e5.js.map
