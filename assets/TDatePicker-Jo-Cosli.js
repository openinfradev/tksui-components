import{j as l}from"./jsx-runtime-CKrituN3.js";import{r}from"./index-CBqU2yxZ.js";import{u as te}from"./UseValidator-XS2alT9g.js";import{T as ae}from"./TTextField-BemzdDDy.js";import{T as C}from"./TIcon-DWitXKJd.js";import{T as ne}from"./TDropHolder-D24J-I9A.js";import{T}from"./TButton-B5_kg9S7.js";import{t as $}from"./ThemeToken.module-BX06fUfM.js";const E=r.createContext({nowDate:null,dateValue:"",handleDateValueChange:a=>a,displayDateObject:null,setDisplayDateObject:null,viewMode:{current:"date",original:"date"},changeViewMode:a=>a,dateRange:{},validDateRange:null,parseDateString:null,parseDateObject:null}),G=["일","월","화","수","목","금","토"],re=({day:a})=>l.jsx("span",{className:"t-day-selector__content__weekday__item",children:a}),le=r.memo(re),L=()=>{const{dateValue:a,handleDateValueChange:b,displayDateObject:i,setDisplayDateObject:x,changeViewMode:y,nowDate:g,parseDateString:s,validDateRange:m}=r.useContext(E),v=r.useMemo(()=>{if(a==="")return{year:null,month:null,day:null};const{year:t,month:n,day:c}=s(a);return t!==0&&n!==0&&c!==0?{year:t,month:n,day:c}:{year:null,month:null,day:null}},[a]),f=r.useMemo(()=>{const t=new Date(i.year,i.month,0).getDate();return Array.from(Array(t).keys())},[i]),h=r.useMemo(()=>new Date(i.year,i.month-1).getDay()+1,[f,i]),M=r.useCallback(t=>{const n=[],{year:c,month:_}=i,{year:D,month:w,day:N}=v;c===D&&_===w&&t===N&&n.push("t-day-selector__content__day-container__item__day--selected"),c===g().year&&_===g().month&&t===g().day&&n.push("t-day-selector__content__day-container__item__day--today");const F=String(i.month).padStart(2,"0"),k=String(t).padStart(2,"0");return m(`${c}${F}${k}`)||n.push("t-day-selector__content__day-container__item__day--disabled"),n.join(" ")},[m,v,i,g]),j=r.useCallback(t=>{const n=i.month>9?i.month:`0${i.month}`,c=t>9?t:`0${t}`,_=`${i.year}${n}${c}`;b&&b(_)},[b,i]),p=r.useCallback(t=>{if(t==="today")x({...g()});else if(t==="next"||t==="prev")x(n=>{const c=t==="next"?1:-1,_=(n.month+c-1+12)%12+1,D=n.year+Math.floor((n.month+c-1)/12);return{...n,month:_,year:D}});else throw new Error("Invalid move value")},[]);return l.jsxs("div",{className:"t-day-selector","data-testid":"t-day-selector",children:[l.jsxs("div",{className:"t-day-selector__header",children:[l.jsxs("div",{className:"t-day-selector__header__current-display-date",children:[l.jsx("div",{className:"t-day-selector-display-year-month","data-testid":"t-day-selector-display-year-month",onClick:()=>{y("month")},children:`${i.year}년 ${i.month}월`}),l.jsx(C,{onClick:()=>{y("year")},xsmall:!0,className:"t-day-selector-display-date__icon",children:"arrow_drop_down"})]}),l.jsxs("div",{className:"t-day-selector__header__control","data-testid":"t-day-selector-control",children:[l.jsx(T,{onClick:()=>{p("prev")},xsmall:!0,className:"t-day-selector__header__control__icon-button",children:l.jsx(C,{xsmall:!0,color:$.tGrayColor5,children:"arrow_left"})}),l.jsx(T,{onClick:()=>{p("today")},xsmall:!0,className:"t-day-selector__header__control__today-button",children:"오늘"}),l.jsx(T,{onClick:()=>{p("next")},xsmall:!0,className:"t-day-selector__header__control__icon-button",children:l.jsx(C,{xsmall:!0,color:$.tGrayColor5,children:"arrow_right"})})]})]}),l.jsxs("div",{className:"t-day-selector__content",children:[l.jsx("div",{className:"t-day-selector__content__weekday",children:G==null?void 0:G.map(t=>l.jsx(le,{day:t},t))}),l.jsx("div",{className:"t-day-selector__content__day-container",children:f==null?void 0:f.map(t=>l.jsx("div",{className:"t-day-selector__content__day-container__item",style:t===0?{gridColumn:h}:{},onClick:()=>{j(t+1)},children:l.jsx("div",{className:`t-day-selector__content__day-container__item__day ${M(t+1)}`,children:t+1})},t))})]})]})};L.defaultProps={};L.displayName="TDaySelector";const oe=[{value:1,label:"Jan"},{value:2,label:"Feb"},{value:3,label:"Mar"},{value:4,label:"Apr"},{value:5,label:"May"},{value:6,label:"Jun"},{value:7,label:"Jul"},{value:8,label:"Aug"},{value:9,label:"Sep"},{value:10,label:"Oct"},{value:11,label:"Nov"},{value:12,label:"Dec"}],B=()=>{const{dateValue:a,handleDateValueChange:b,displayDateObject:i,setDisplayDateObject:x,changeViewMode:y,nowDate:g,viewMode:s,validDateRange:m}=r.useContext(E),v=r.useMemo(()=>{if(a==="")return{year:null,month:null,day:null};const t=Number(a.substring(0,4)),n=Number(a.substring(4,6));return t!==0&&n!==0?{year:t,month:n,day:null}:{year:null,month:null,day:null}},[a]),f=r.useCallback(t=>{const n=[],{year:c}=i,_=String(t).padStart(2,"0");return i.year===v.year&&t===v.month&&n.push("t-month-selector__content__month-container__item__month--selected"),i.year===g().year&&t===g().month&&n.push("t-month-selector__content__month-container__item__month--today"),m(`${c}${_}`)||n.push("t-month-selector__content__month-container__item__month--disabled"),n.join(" ")},[v,i,m,g]),h=r.useMemo(()=>s.original!==s.current?"t-month-selector__header__current-display-date__icon--open":"",[s]),M=r.useCallback(t=>{const n=t>9?t:`0${t}`,c=`${i.year}${n}`;if(s.current!==s.original){x(_=>({..._,year:i.year,month:t})),y("date");return}m(c)&&b(c)},[s,i,b]),j=r.useCallback(t=>{x(n=>{const c=t==="next"?1:-1,_=n.year+c;return _>=1e3&&_<=9999?{...n,year:_}:n})},[]),p=r.useCallback(()=>{s.original!==s.current&&y(s.original),s.original===s.current&&y("year")},[s,y]);return l.jsxs("div",{className:"t-month-selector","data-testid":"t-month-selector",children:[l.jsxs("div",{className:"t-month-selector__header",children:[l.jsxs("div",{className:"t-month-selector__header__current-display-date",children:[l.jsx("div",{"data-testid":"t-month-selector-display-year",children:`${i.year}년`}),l.jsx(C,{xsmall:!0,className:`t-month-selector-display-date__icon ${h}`,onClick:p,children:"arrow_drop_down"})]}),l.jsxs("div",{className:"t-month-selector__header__control",children:[l.jsx(T,{onClick:()=>{j("prev")},xsmall:!0,className:"t-month-selector__header__control__icon-button",children:l.jsx(C,{xsmall:!0,color:$.tGrayColor5,children:"arrow_left"})}),l.jsx(T,{onClick:()=>{j("next")},xsmall:!0,className:"t-month-selector__header__control__icon-button",children:l.jsx(C,{xsmall:!0,color:$.tGrayColor5,children:"arrow_right"})})]})]}),l.jsx("div",{className:"t-month-selector__content","data-testid":"t-month-selector-control",children:l.jsx("div",{className:"t-month-selector__content__month-container",children:oe.map((t,n)=>l.jsx("span",{className:`t-month-selector__content__month__item ${f(n+1)}`,onClick:()=>{M(t.value)},children:t.value},t.value))})})]})};B.defaultProps={};B.displayName="TMonthSelector";const J=()=>{const{dateValue:a,handleDateValueChange:b,displayDateObject:i,setDisplayDateObject:x,changeViewMode:y,validDateRange:g,nowDate:s,viewMode:m}=r.useContext(E),v=r.useMemo(()=>{const n=Math.floor(i.year/10)*10;return Array.from({length:10},(c,_)=>n+_)},[i]),f=r.useMemo(()=>a===""?{year:null,month:null,day:null}:{year:Number(a.substring(0,4)),month:null,day:null},[a]),h=r.useCallback(n=>{const c=[];return n===f.year&&c.push("t-year-selector__content__year-container__item__year--selected"),n===s().year&&c.push("t-year-selector__content__year-container__item__year--today"),g(`${n}`)||c.push("t-year-selector__content__year-container__item__year--disabled"),c.join(" ")},[f,i,s,g]),M=r.useMemo(()=>m.original!==m.current?"t-year-selector__header__current-display-date__icon--open":"",[m]),j=r.useCallback(n=>{if(m.current!==m.original){x(c=>({...c,year:n})),y(m.original);return}g(n==null?void 0:n.toString())&&b(n==null?void 0:n.toString())},[b]),p=r.useCallback(n=>{if(n==="next"||n==="prev")x(c=>{const _=n==="next"?10:-10,D=c.year+_;return D>=1e3&&D<=9999?{...c,year:D}:c});else throw new Error("Invalid move value")},[]),t=r.useCallback(()=>{m.original!==m.current&&y(m.original)},[m,y]);return l.jsxs("div",{className:"t-year-selector","data-testid":"t-year-selector",children:[l.jsxs("div",{className:"t-year-selector__header",children:[l.jsxs("div",{className:"t-year-selector__header__current-display-date",children:[l.jsx("div",{onClick:()=>{y("year")},children:`${v[0]}년 - ${v[v.length-1]}년`}),l.jsx(C,{xsmall:!0,onClick:t,className:`t-year-selector__header__current-display-date__icon ${M}`,children:"arrow_drop_down"})]}),l.jsxs("div",{className:"t-year-selector__header__control",children:[l.jsx(T,{onClick:()=>{p("prev")},xsmall:!0,className:"t-year-selector__header__control__icon-button",children:l.jsx(C,{xsmall:!0,color:$.tGrayColor5,children:"arrow_left"})}),l.jsx(T,{onClick:()=>{p("next")},xsmall:!0,className:"t-year-selector__header__control__icon-button",children:l.jsx(C,{xsmall:!0,color:$.tGrayColor5,children:"arrow_right"})})]})]}),l.jsx("div",{className:"t-year-selector__content","data-testid":"t-day-selector-control",children:l.jsx("div",{className:"t-year-selector__content__year-container",children:v.map(n=>l.jsx("span",{className:`t-year-selector__content__year-container__item ${h(n)}`,onClick:()=>{j(n)},children:n},n))})})]})};J.defaultProps={};J.displayName="TYearSelector";const I=()=>({year:new Date().getFullYear(),month:new Date().getMonth()+1,day:new Date().getDate()}),q=r.forwardRef((a,b)=>{const i=r.useRef(null),x=r.useRef(null),y=r.useRef(null),g=te(a.value,a.rules,a.successMessage),[s,m]=r.useState(a.view),[v,f]=r.useState(""),[h,M]=r.useState(a.value),[j,p]=r.useState({...I()}),[t,n]=r.useState({openFrom:void 0,openTo:void 0});r.useImperativeHandle(b,()=>({focus(){var e;(e=i==null?void 0:i.current)==null||e.focus()},open(){var e;(e=y==null?void 0:y.current)==null||e.open()},validate(){return g.validate()},getDate(){return h}}));const c=r.useMemo(()=>{const e=[];return a.className&&e.push(a.className),a.disabled&&e.push("t-date-picker--disabled"),e.join(" ")},[a.className,a.disabled]),_=r.useMemo(()=>a.style?a.style:{},[a.style]),D=r.useCallback(e=>{const o=e.length,d=e.substring(0,4),u=e.substring(4,6),V=e.substring(6,8);return o<5?d:o<7?`${d}${a.separator}${u}`:`${d}${a.separator}${u}${a.separator}${V}`},[]),w=r.useCallback(e=>{let o=8;return s==="month"?o=6:s==="year"&&(o=4),e==null?void 0:e.replace(/\D/g,"").replace(/^0+/,"").substring(0,o)},[s]),N=r.useCallback(e=>{const o=e==null?void 0:e.substring(0,4),d=e==null?void 0:e.substring(4,6),u=e==null?void 0:e.substring(6,8);return{year:Number(o),month:Number(d),day:Number(u)}},[]),F=r.useCallback(({year:e,month:o,day:d})=>{const u=V=>String(V).padStart(2,"0");return`${e}${u(o)}${u(d)}`},[]),k=r.useCallback(e=>{const{year:o,month:d,day:u}=N(e),V=new Date(o,d,0).getDate(),S=o>999,P=d>0&&d<13,R=u>0&&u<=V;if(s==="date"){if(S&&P&&R)return!0}else if(s==="month"){if(S&&P)return!0}else if(s==="year"&&S)return!0;return!1},[s]),O=r.useCallback(e=>{const o=Number(e),d=w(t.openFrom),u=w(t.openTo);return d&&u?o>=Number(d)&&o<=Number(u):d?Number(d)<=o:u?Number(u)>=o:!0},[t,w]),W=r.useCallback(e=>{(a.view==="date"||a.view==="month"&&e!=="date")&&m(e)},[a.view]),A=r.useCallback(e=>{var o;f(e),M(e),a.onChange&&a.onChange(D(e)),(o=y.current)==null||o.close()},[a.onChange]),z=r.useCallback(()=>{f(""),M(""),a.onChange&&a.onChange("")},[a.onChange]),K=r.useCallback(()=>{const e=k(h),o=O(h);(s==="date"||s==="month"||s==="year")&&(e&&o?f(h):z())},[h,s]),Q=r.useCallback(()=>{const e=w(a.openFrom),o=w(a.openTo),d=k(e),u=k(o);if(e&&o&&!d&&!u)throw Error("Error: openFrom and openTo prop invalid value.");if(e&&!o&&!d)throw Error("Error: openFrom prop invalid value.");if(!e&&o&&!u)throw Error("Error: openTo prop invalid value.");n({openFrom:d?e:void 0,openTo:u?o:void 0})},[a.openFrom,a.openTo]),H=r.useCallback(()=>{m(a.view);const{year:e,month:o}=N(h);if(e!==0&&o!==0)p({year:e,month:o,day:null});else if(t.openFrom&&t.openTo){const{year:d,month:u}=N(t.openFrom);p({year:d,month:u,day:null})}else if(t.openFrom&&!t.openTo){const{year:d,month:u}=N(t.openFrom);p({year:d,month:u,day:null})}else if(!t.openFrom&&t.openTo){const{year:d,month:u}=N(t.openTo);p({year:d,month:u,day:null})}else p(e!==0&&o===0?d=>({...d,year:e,month:1}):I())},[h,t,a.view]),U=r.useCallback(e=>{const o=w(e);f(o)},[]),Y=r.useCallback((e=v)=>{const o=w(e);if(o===""){z();return}const d=k(o),u=O(o),{year:V,month:S,day:P}=N(o),R=F({year:V,month:S,day:P});if(d&&u&&s==="date")A(R);else if(d&&u&&s==="month"){const ee=R.substring(0,6);A(ee)}else d&&u&&s==="year"?A(V.toString()):K()},[v,t,j,O,k]),X=r.useCallback(()=>{Y()},[Y]),Z=r.useCallback(e=>{e.stopPropagation()},[]);return r.useEffect(()=>{Y(a.value)},[a.value]),r.useEffect(()=>{Q()},[a.openFrom,a.openTo]),r.useEffect(()=>{H()},[h]),l.jsx("div",{ref:i,className:`t-date-picker ${c}`,style:_,"data-testid":"t-date-picker",children:l.jsx(ae,{ref:x,className:"t-date-picker__text-field",value:D(v),onChange:U,onBlur:X,width:"156px",disabled:a.disabled,customAction:l.jsx(ne,{ref:y,className:"t-date-picker__drop-holder",alignment:"bottom-center",offset:"16px",customItem:!a.disabled&&l.jsx(E.Provider,{value:{nowDate:I,dateValue:h,handleDateValueChange:Y,displayDateObject:j,setDisplayDateObject:p,viewMode:{current:s,original:a.view},changeViewMode:W,dateRange:t,validDateRange:O,parseDateString:N,parseDateObject:F},children:l.jsxs("div",{className:"t-date-picker__drop-holder__item__wrapper",onClick:Z,children:[s==="date"&&l.jsx(L,{}),s==="month"&&l.jsx(B,{}),s==="year"&&l.jsx(J,{})]})}),children:l.jsx(C,{medium:!0,onClick:H,color:$.tGrayColor3,children:"calendar_month"})})})})});q.defaultProps={value:"",view:"date",separator:"-"};q.displayName="TDatePicker";try{q.displayName="TDatePicker",q.__docgenInfo={description:"",displayName:"TDatePicker",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},value:{defaultValue:{value:""},description:"",name:"value",required:!1,type:{name:"string"}},openFrom:{defaultValue:null,description:"",name:"openFrom",required:!1,type:{name:"string"}},openTo:{defaultValue:null,description:"",name:"openTo",required:!1,type:{name:"string"}},view:{defaultValue:{value:"date"},description:"",name:"view",required:!1,type:{name:"enum",value:[{value:'"date"'},{value:'"month"'},{value:'"year"'}]}},dateFormat:{defaultValue:null,description:"",name:"dateFormat",required:!1,type:{name:"enum",value:[{value:'"YYYY-MM-DD"'},{value:'"DD-MM-YYYY"'},{value:'"MM-DD-YYYY"'}]}},separator:{defaultValue:{value:"-"},description:"",name:"separator",required:!1,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"(value: string | boolean, positiveValue?: string | boolean) => void"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}},id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}},lazy:{defaultValue:null,description:"",name:"lazy",required:!1,type:{name:"boolean"}},rules:{defaultValue:null,description:"",name:"rules",required:!1,type:{name:"((value: any) => string | true)[]"}},successMessage:{defaultValue:null,description:"",name:"successMessage",required:!1,type:{name:"string"}}}}}catch{}export{q as T};
