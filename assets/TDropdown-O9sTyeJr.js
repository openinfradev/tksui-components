import{j as n}from"./jsx-runtime-vNq4Oc-g.js";import{r as t}from"./index-4g5l5LRQ.js";import{u as A}from"./UseValidator-M-ibdt69.js";import{u as B}from"./UseClickOutside-kZ9I5LnS.js";import{T as J}from"./TCheckbox-0tqUoP6c.js";import{T as Q}from"./TTextField-43Owqifa.js";import{T as U}from"./THighlightText-ZPE0hcwY.js";import{T as V}from"./TIcon-bZ1YQzj2.js";import{T as W}from"./TChip-dnrIdSm7.js";import{t as v}from"./ThemeToken.module-dCmVaUNK.js";const h=t.forwardRef((e,j)=>{var T;const i=A(e.value,e.rules,e.successMessage),K=t.useRef(null),c=t.useRef(null),C=t.useRef(null),[d,w]=t.useState(""),[s,g]=t.useState(!1),[m,N]=t.useState(new Map);t.useImperativeHandle(j,()=>({focus(){var l;(l=c==null?void 0:c.current)==null||l.focus()},validate(){return i.validate()}}));const r=t.useCallback(()=>{c.current.focus()},[]),f=t.useCallback(l=>{e.onChange(l),e.multiple?e.value.includes(l)?e.onChange(e.value.filter(a=>a!==l)):e.onChange([...e.value,l]):e.onChange(l)},[e]),b=t.useCallback(()=>{e.onChange("")},[e]),q=t.useCallback(()=>{const l=new Map;e.items.forEach(a=>{l.set(a[e.valueKey],a)}),N(l)},[e.items,e.valueKey]),u=t.useCallback(l=>{g(!1),w(""),l&&r()},[r]),k=t.useCallback(()=>{g(!0),i.clearValidation()},[i]),y=t.useCallback(()=>{s?u(!0):k()},[u,s,k]),o=t.useCallback(l=>l?e.itemTemplate?e.itemTemplate(l):l[e.textKey]:"",[e]),_=t.useCallback(()=>!e.multiple&&d===o(m.get(e.value))?e.items:e.items.filter(l=>o(l).toLowerCase().includes(d==null?void 0:d.toLowerCase())),[d,o,m,e.items,e.multiple,e.value]),D=t.useMemo(()=>{const l=[];return e.className&&l.push(e.className),s&&l.push("t-dropdown--open"),e.disabled&&l.push("t-dropdown--disabled"),i.result||l.push("t-dropdown--failure"),i.result&&i.message&&l.push("t-dropdown--success"),l.push(`t-dropdown--${e.type}`),l.join(" ")},[s,e.className,e.disabled,e.type,i.message,i.result]),z=t.useMemo(()=>{var a;const l=[];return((a=e.value)==null?void 0:a.length)===0&&l.push("t-dropdown__control__selected--empty"),l.join(" ")},[(T=e.value)==null?void 0:T.length]),M=t.useMemo(()=>{const l=[];return s&&l.push("t-dropdown__items--open"),e.noDetail&&l.push("t-dropdown__items--no-detail"),_().length===0&&l.push("t-dropdown__items--empty"),l.join(" ")},[_,s,e.noDetail]),I=t.useCallback(l=>{const a=[];return(typeof e.value=="object"&&e.value.includes(l[e.valueKey])||typeof e.value=="string"&&e.value===l[e.valueKey])&&a.push("t-dropdown__items__item--selected"),a.join(" ")},[e.value,e.valueKey]),E=t.useMemo(()=>{let l={};return e.style&&(l={...e.style}),e.width&&(l={...l,width:e.width}),l},[e.style,e.width]),P=t.useCallback(()=>{y(),r()},[r,y]),R=t.useCallback(l=>{l.stopPropagation(),b()},[b]),x=t.useCallback(l=>{f(l),e.multiple||u(!0)},[u,f,e.multiple]),$=t.useCallback(()=>{!s&&!e.lazy&&i.validate()},[s,e.lazy,i]),F=t.useCallback(l=>{w(l)},[]),S=t.useCallback(l=>{l.key==="Escape"&&u(!0)},[u]),O=t.useCallback(l=>{l.key==="Escape"&&u(!0),(l.key==="Enter"||l.key===" ")&&y()},[u,y]),G=t.useCallback((l,a)=>{l.key==="Escape"&&u(!0),l.key==="Enter"&&(f(a),e.multiple||(r(),u(!0)))},[u,r,f,e.multiple]),H=t.useCallback(()=>{e.multiple||e.onChange("")},[e]),L=t.useMemo(()=>{var l;return((l=e.value)==null?void 0:l.length)===0?e.placeholder:null},[e.value,e.placeholder]);return B(C,()=>u(!1)),t.useEffect(()=>{q()},[e.items,e.valueKey]),n.jsxs("div",{ref:C,className:`t-dropdown ${D}`,style:E,onBlur:$,id:e.id,"data-testid":"dropdown-root",children:[n.jsxs("div",{className:"t-dropdown__control",tabIndex:e.disabled?-1:0,onKeyDown:O,ref:c,onClick:P,children:[n.jsxs("div",{className:`t-dropdown__control__selected ${z}`,children:[L,e.multiple&&e.chip&&e.value.map(l=>n.jsx(W,{onRemove:e.disabled?null:()=>x(l),children:o(m.get(l))},l)),e.multiple&&!e.chip&&e.value.map(l=>o(m.get(l))).join(", "),!e.multiple&&o(m.get(e.value))]}),!e.multiple&&e.value&&n.jsx(V,{className:"t-dropdown__control__remover",small:!0,fill:!0,color:v.tGrayColor3,onClick:R,children:"cancel"}),n.jsx(V,{className:`t-dropdown__control__opener ${s?"t-dropdown__control__opener--open":""}`,color:e.disabled?v.tGrayColor4:v.tGrayColor6,children:"arrow_drop_down"})]}),n.jsxs("div",{className:`t-dropdown__items ${M}`,children:[n.jsx(Q,{ref:K,className:"t-dropdown__items__filter-text",value:d,placeholder:e.filterPlaceholder,disabled:e.disabled,noTrim:!0,searchable:!0,onChange:F,onClear:H,onKeyDown:S}),n.jsxs("div",{className:"t-dropdown__items__wrapper",children:[s&&_().map(l=>n.jsxs("div",{className:`t-dropdown__items__item ${I(l)}`,tabIndex:e.multiple?-1:0,onClickCapture:()=>x(l[e.valueKey]),onKeyDown:a=>G(a,l[e.valueKey]),children:[e.multiple&&n.jsx(J,{className:"t-dropdown__items__item__checkbox",checked:e.value.includes(l[e.valueKey])}),n.jsx(U,{keyword:d,children:o(l)})]},l[e.valueKey])),s&&_().length===0&&n.jsx("div",{className:"t-dropdown__items__item t-dropdown__items__item--no-result",children:"검색 결과가 없습니다."})]})]}),!e.noDetail&&n.jsx("div",{className:"t-dropdown__details",children:n.jsx("div",{className:"t-dropdown__details__message",children:i.message&&`${i.message}`})})]})});h.defaultProps={type:"outline",valueKey:"value",textKey:"text",placeholder:"선택",filterPlaceholder:"검색",chip:!0,lazy:!0};h.displayName="TDropdown";try{h.displayName="TDropdown",h.__docgenInfo={description:"",displayName:"TDropdown",props:{itemsClassName:{defaultValue:null,description:"",name:"itemsClassName",required:!1,type:{name:"string"}},type:{defaultValue:{value:"outline"},description:"",name:"type",required:!1,type:{name:"enum",value:[{value:'"outline"'},{value:'"underline"'}]}},width:{defaultValue:null,description:"",name:"width",required:!1,type:{name:"string"}},items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"TDropdownItem[]"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"TDropdownValue"}},multiple:{defaultValue:null,description:"",name:"multiple",required:!1,type:{name:"boolean"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},noDetail:{defaultValue:null,description:"",name:"noDetail",required:!1,type:{name:"boolean"}},placeholder:{defaultValue:{value:"선택"},description:"",name:"placeholder",required:!1,type:{name:"string"}},filterPlaceholder:{defaultValue:{value:"검색"},description:"",name:"filterPlaceholder",required:!1,type:{name:"string"}},textKey:{defaultValue:{value:"text"},description:"",name:"textKey",required:!1,type:{name:"string"}},valueKey:{defaultValue:{value:"value"},description:"",name:"valueKey",required:!1,type:{name:"string"}},itemTemplate:{defaultValue:null,description:"",name:"itemTemplate",required:!1,type:{name:"(item: TDropdownItem) => string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: string | string[]) => void"}},chip:{defaultValue:{value:"true"},description:"",name:"chip",required:!1,type:{name:"boolean"}},lazy:{defaultValue:{value:"true"},description:"",name:"lazy",required:!1,type:{name:"boolean"}},rules:{defaultValue:null,description:"",name:"rules",required:!1,type:{name:"((value: any) => string | true)[]"}},successMessage:{defaultValue:null,description:"",name:"successMessage",required:!1,type:{name:"string"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}},id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}}}}}catch{}export{h as T};
