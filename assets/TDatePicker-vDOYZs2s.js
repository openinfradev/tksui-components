import{j as n}from"./jsx-runtime-CKrituN3.js";import{r as l}from"./index-CBqU2yxZ.js";import{u as U}from"./UseValidator-XS2alT9g.js";import{T as X}from"./TTextField-BGZCoOEs.js";import{T as C}from"./TIcon-CuhwYyyf.js";import{T as Z}from"./TDropHolder-DMinaWB5.js";import{T as V}from"./TButton-Bzqw7imh.js";import{t as w}from"./ThemeToken.module-BX06fUfM.js";const O=l.createContext({nowDate:null,dateValue:"",onChangeValue:e=>e,displayDateObject:null,setDisplayDateObject:null,viewMode:{current:"date",original:"date"},changeViewMode:e=>e,dateRange:{},validDateRange:null,parseDateString:null,parseDateObject:null}),R=["일","월","화","수","목","금","토"],ee=({day:e})=>n.jsx("span",{className:"t-day-selector__content__weekday__item",children:e}),te=l.memo(ee),q=()=>{const{dateValue:e,onChangeValue:u,displayDateObject:r,setDisplayDateObject:d,changeViewMode:i,nowDate:m,parseDateString:s,validDateRange:_}=l.useContext(O),v=l.useMemo(()=>{if(e==="")return{year:null,month:null,day:null};const{year:t,month:a,day:c}=s(e);return t!==0&&a!==0&&c!==0?{year:t,month:a,day:c}:{year:null,month:null,day:null}},[e]),p=l.useMemo(()=>{const t=new Date(r.year,r.month,0).getDate();return Array.from(Array(t).keys())},[r]),D=l.useMemo(()=>new Date(r.year,r.month-1).getDay()+1,[p,r]),T=l.useCallback(t=>{const a=[],{year:c,month:h}=r,{year:x,month:z,day:M}=v;c===x&&h===z&&t===M&&a.push("t-day-selector__content__day-container__item__day--selected"),c===m().year&&h===m().month&&t===m().day&&a.push("t-day-selector__content__day-container__item__day--today");const k=String(r.month).padStart(2,"0"),S=String(t).padStart(2,"0");return _(`${c}${k}${S}`)||a.push("t-day-selector__content__day-container__item__day--disabled"),a.join(" ")},[_,v,r,m]),N=l.useCallback(t=>{const a=r.month>9?r.month:`0${r.month}`,c=t>9?t:`0${t}`,h=`${r.year}${a}${c}`;u&&u(h)},[u,r]),g=l.useCallback(t=>{if(t==="today")d({...m()});else if(t==="next"||t==="prev")d(a=>{const c=t==="next"?1:-1,h=(a.month+c-1+12)%12+1,x=a.year+Math.floor((a.month+c-1)/12);return{...a,month:h,year:x}});else throw new Error("Invalid move value")},[]);return n.jsxs("div",{className:"t-day-selector","data-testid":"t-day-selector",children:[n.jsxs("div",{className:"t-day-selector__header",children:[n.jsxs("div",{className:"t-day-selector__header__current-display-date",children:[n.jsx("div",{className:"t-day-selector-display-year-month","data-testid":"t-day-selector-display-year-month",onClick:()=>{i("month")},children:`${r.year}년 ${r.month}월`}),n.jsx(C,{onClick:()=>{i("year")},xsmall:!0,className:"t-day-selector-display-date__icon",children:"arrow_drop_down"})]}),n.jsxs("div",{className:"t-day-selector__header__control","data-testid":"t-day-selector-control",children:[n.jsx(V,{onClick:()=>{g("prev")},xsmall:!0,className:"t-day-selector__header__control__icon-button",children:n.jsx(C,{xsmall:!0,color:w.tGrayColor5,children:"arrow_left"})}),n.jsx(V,{onClick:()=>{g("today")},xsmall:!0,className:"t-day-selector__header__control__today-button",children:"오늘"}),n.jsx(V,{onClick:()=>{g("next")},xsmall:!0,className:"t-day-selector__header__control__icon-button",children:n.jsx(C,{xsmall:!0,color:w.tGrayColor5,children:"arrow_right"})})]})]}),n.jsxs("div",{className:"t-day-selector__content",children:[n.jsx("div",{className:"t-day-selector__content__weekday",children:R==null?void 0:R.map(t=>n.jsx(te,{day:t},t))}),n.jsx("div",{className:"t-day-selector__content__day-container",children:p==null?void 0:p.map(t=>n.jsx("div",{className:"t-day-selector__content__day-container__item",style:t===0?{gridColumn:D}:{},onClick:()=>{N(t+1)},children:n.jsx("div",{className:`t-day-selector__content__day-container__item__day ${T(t+1)}`,children:t+1})},t))})]})]})};q.defaultProps={};q.displayName="TDaySelector";const ae=[{value:1,label:"Jan"},{value:2,label:"Feb"},{value:3,label:"Mar"},{value:4,label:"Apr"},{value:5,label:"May"},{value:6,label:"Jun"},{value:7,label:"Jul"},{value:8,label:"Aug"},{value:9,label:"Sep"},{value:10,label:"Oct"},{value:11,label:"Nov"},{value:12,label:"Dec"}],I=()=>{const{dateValue:e,onChangeValue:u,displayDateObject:r,setDisplayDateObject:d,changeViewMode:i,nowDate:m,viewMode:s,validDateRange:_}=l.useContext(O),v=l.useMemo(()=>{if(e==="")return{year:null,month:null,day:null};const t=Number(e.substring(0,4)),a=Number(e.substring(4,6));return t!==0&&a!==0?{year:t,month:a,day:null}:{year:null,month:null,day:null}},[e]),p=l.useCallback(t=>{const a=[],{year:c}=r,h=String(t).padStart(2,"0");return r.year===v.year&&t===v.month&&a.push("t-month-selector__content__month-container__item__month--selected"),r.year===m().year&&t===m().month&&a.push("t-month-selector__content__month-container__item__month--today"),_(`${c}${h}`)||a.push("t-month-selector__content__month-container__item__month--disabled"),a.join(" ")},[v,r,_,m]),D=l.useMemo(()=>s.original!==s.current?"t-month-selector__header__current-display-date__icon--open":"",[s]),T=l.useCallback(t=>{const a=t>9?t:`0${t}`,c=`${r.year}${a}`;if(s.current!==s.original){d(h=>({...h,year:r.year,month:t})),i("date");return}_(c)&&u(c)},[s,r,u]),N=l.useCallback(t=>{d(a=>{const c=t==="next"?1:-1,h=a.year+c;return h>=1e3&&h<=9999?{...a,year:h}:a})},[]),g=l.useCallback(()=>{s.original!==s.current&&i(s.original),s.original===s.current&&i("year")},[s,i]);return n.jsxs("div",{className:"t-month-selector","data-testid":"t-month-selector",children:[n.jsxs("div",{className:"t-month-selector__header",children:[n.jsxs("div",{className:"t-month-selector__header__current-display-date",children:[n.jsx("div",{"data-testid":"t-month-selector-display-year",children:`${r.year}년`}),n.jsx(C,{xsmall:!0,className:`t-month-selector-display-date__icon ${D}`,onClick:g,children:"arrow_drop_down"})]}),n.jsxs("div",{className:"t-month-selector__header__control",children:[n.jsx(V,{onClick:()=>{N("prev")},xsmall:!0,className:"t-month-selector__header__control__icon-button",children:n.jsx(C,{xsmall:!0,color:w.tGrayColor5,children:"arrow_left"})}),n.jsx(V,{onClick:()=>{N("next")},xsmall:!0,className:"t-month-selector__header__control__icon-button",children:n.jsx(C,{xsmall:!0,color:w.tGrayColor5,children:"arrow_right"})})]})]}),n.jsx("div",{className:"t-month-selector__content","data-testid":"t-month-selector-control",children:n.jsx("div",{className:"t-month-selector__content__month-container",children:ae.map((t,a)=>n.jsx("span",{className:`t-month-selector__content__month__item ${p(a+1)}`,onClick:()=>{T(t.value)},children:t.value},t.value))})})]})};I.defaultProps={};I.displayName="TMonthSelector";const E=()=>{const{dateValue:e,onChangeValue:u,displayDateObject:r,setDisplayDateObject:d,changeViewMode:i,validDateRange:m,nowDate:s,viewMode:_}=l.useContext(O),v=l.useMemo(()=>{const a=Math.floor(r.year/10)*10;return Array.from({length:10},(c,h)=>a+h)},[r]),p=l.useMemo(()=>e===""?{year:null,month:null,day:null}:{year:Number(e.substring(0,4)),month:null,day:null},[e]),D=l.useCallback(a=>{const c=[];return a===p.year&&c.push("t-year-selector__content__year-container__item__year--selected"),a===s().year&&c.push("t-year-selector__content__year-container__item__year--today"),m(`${a}`)||c.push("t-year-selector__content__year-container__item__year--disabled"),c.join(" ")},[p,s,m]),T=l.useMemo(()=>_.original!==_.current?"t-year-selector__header__current-display-date__icon--open":"",[_]),N=l.useCallback(a=>{if(_.current!==_.original){d(c=>({...c,year:a})),i(_.original);return}m(a==null?void 0:a.toString())&&u(a==null?void 0:a.toString())},[u]),g=l.useCallback(a=>{if(a==="next"||a==="prev")d(c=>{const h=a==="next"?10:-10,x=c.year+h;return x>=1e3&&x<=9999?{...c,year:x}:c});else throw new Error("Invalid move value")},[]),t=l.useCallback(()=>{_.original!==_.current&&i(_.original)},[_,i]);return n.jsxs("div",{className:"t-year-selector","data-testid":"t-year-selector",children:[n.jsxs("div",{className:"t-year-selector__header",children:[n.jsxs("div",{className:"t-year-selector__header__current-display-date",children:[n.jsx("div",{onClick:()=>{i("year")},children:`${v[0]}년 - ${v[v.length-1]}년`}),n.jsx(C,{xsmall:!0,onClick:t,className:`t-year-selector__header__current-display-date__icon ${T}`,children:"arrow_drop_down"})]}),n.jsxs("div",{className:"t-year-selector__header__control",children:[n.jsx(V,{onClick:()=>{g("prev")},xsmall:!0,className:"t-year-selector__header__control__icon-button",children:n.jsx(C,{xsmall:!0,color:w.tGrayColor5,children:"arrow_left"})}),n.jsx(V,{onClick:()=>{g("next")},xsmall:!0,className:"t-year-selector__header__control__icon-button",children:n.jsx(C,{xsmall:!0,color:w.tGrayColor5,children:"arrow_right"})})]})]}),n.jsx("div",{className:"t-year-selector__content","data-testid":"t-day-selector-control",children:n.jsx("div",{className:"t-year-selector__content__year-container",children:v.map(a=>n.jsx("span",{className:`t-year-selector__content__year-container__item ${D(a)}`,onClick:()=>{N(a)},children:a},a))})})]})};E.defaultProps={};E.displayName="TYearSelector";const L=e=>{const u=e==null?void 0:e.substring(0,4),r=e==null?void 0:e.substring(4,6),d=e==null?void 0:e.substring(6,8);return{year:Number(u),month:Number(r),day:Number(d)}},ne=({year:e,month:u,day:r})=>{const d=i=>String(i).padStart(2,"0");return`${e}${d(u)}${d(r)}`},re=(e,u)=>{const r=e.length,d=e.substring(0,4),i=e.substring(4,6),m=e.substring(6,8);return r<5?d:r<7?`${d}${u}${i}`:`${d}${u}${i}${u}${m}`},P=(e,u)=>{let r=8;return u==="month"?r=6:u==="year"&&(r=4),e==null?void 0:e.replace(/\D/g,"").replace(/^0+/,"").substring(0,r)},le=(e,u)=>{const{year:r,month:d,day:i}=L(e),m=new Date(r,d,0).getDate(),s=r>999,_=d>0&&d<13,v=i>0&&i<=m;if(u==="date"){if(s&&_&&v)return!0}else if(u==="month"){if(s&&_)return!0}else if(u==="year"&&s)return!0;return!1},oe=(e,u,r)=>{const d=Number(e),i=P(r.openFrom,u),m=P(r.openTo,u);return i&&m?d>=Number(i)&&d<=Number(m):i?Number(i)<=d:m?Number(m)>=d:!0},se=()=>{const e=new Date;return{year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()}},y={convertToDateValue:L,convertToDateString:ne,addDateSeparator:re,sanitizeDateInput:P,validateDateFormat:le,validateDateRange:oe,currentDateValue:se},F=l.forwardRef((e,u)=>{const r=l.useRef(null),d=l.useRef(null),i=l.useRef(null),m=U(e.value,e.rules,e.successMessage),[s,_]=l.useState(e.valueType),[v,p]=l.useState(""),[D,T]=l.useState(e.value),[N,g]=l.useState({...y.currentDateValue()}),[t,a]=l.useState({openFrom:void 0,openTo:void 0});l.useImperativeHandle(u,()=>({focus(){var o;(o=r==null?void 0:r.current)==null||o.focus()},open(){var o;(o=i==null?void 0:i.current)==null||o.open()},validate(){return m.validate()},getDate(){return D}}));const c=l.useMemo(()=>{const o=[];return e.className&&o.push(e.className),e.disabled&&o.push("t-date-picker--disabled"),o.join(" ")},[e.className,e.disabled]),h=l.useMemo(()=>e.style?e.style:{},[e.style]),x=l.useCallback(o=>y.validateDateRange(o,s,t),[t,s]),z=l.useCallback(o=>{(e.valueType==="date"||e.valueType==="month"&&o!=="date")&&_(o)},[e.valueType]),M=l.useCallback(o=>{var f,b;p(o),T(o),(f=e.onChange)==null||f.call(e,y.addDateSeparator(o,e.separator)),(b=i.current)==null||b.close()},[e.onChange]),k=l.useCallback(()=>{var o;p(""),T(""),(o=e.onChange)==null||o.call(e,"")},[e.onChange]),S=l.useCallback(()=>{const o=y.validateDateFormat(D,s),f=x(D);o&&f?p(D):k()},[D,s,x,k]),B=l.useCallback(()=>{const o=y.sanitizeDateInput(e.openFrom,e.valueType),f=y.sanitizeDateInput(e.openTo,e.valueType),b=!o||y.validateDateFormat(o,s),j=!f||y.validateDateFormat(f,s);if(!b||!j)throw Error(`Error: Invalid date range value. openFrom: ${o}, openTo: ${f}`);a({openFrom:o,openTo:f})},[e.openFrom,e.openTo,e.valueType,s]),A=l.useCallback(()=>{_(e.valueType);const{year:o,month:f}=y.convertToDateValue(D);if(o!==0&&f!==0)g({year:o,month:f,day:null});else if(t.openFrom&&t.openTo){const{year:b,month:j}=y.convertToDateValue(t.openFrom);g({year:b,month:j,day:null})}else if(t.openFrom&&!t.openTo){const{year:b,month:j}=y.convertToDateValue(t.openFrom);g({year:b,month:j,day:null})}else if(!t.openFrom&&t.openTo){const{year:b,month:j}=y.convertToDateValue(t.openTo);g({year:b,month:j,day:null})}else g(o!==0&&f===0?b=>({...b,year:o,month:1}):y.currentDateValue())},[D,t,e.valueType]),$=l.useCallback((o=v)=>{const f=y.sanitizeDateInput(o,e.valueType);if(!f){k();return}const b=y.validateDateFormat(f,s),j=x(f),{year:G,month:K,day:Q}=y.convertToDateValue(f),Y=y.convertToDateString({year:G,month:K,day:Q});if(b&&j)switch(s){case"date":{M(Y);break}case"month":{M(Y.substring(0,6));break}case"year":{M(G.toString());break}default:{S();break}}else S()},[v,e.valueType,s,x,k,M,S]),H=l.useCallback(o=>{const f=y.sanitizeDateInput(o,e.valueType);p(f)},[]),J=l.useCallback(()=>{$()},[$]),W=l.useCallback(o=>{o.stopPropagation()},[]);return l.useEffect(()=>{$(e.value)},[e.value]),l.useEffect(()=>{B()},[e.openFrom,e.openTo]),l.useEffect(()=>{A()},[D]),n.jsx("div",{ref:r,className:`t-date-picker ${c}`,style:h,"data-testid":"t-date-picker",children:n.jsx(X,{ref:d,className:"t-date-picker__text-field",value:y.addDateSeparator(v,e.separator),onChange:H,onBlur:J,width:"156px",disabled:e.disabled,customAction:n.jsx(Z,{ref:i,className:"t-date-picker__drop-holder",alignment:"bottom-center",offset:"16px",customItem:!e.disabled&&n.jsx(O.Provider,{value:{dateValue:D,onChangeValue:$,displayDateObject:N,setDisplayDateObject:g,viewMode:{current:s,original:e.valueType},changeViewMode:z,dateRange:t,validDateRange:x,nowDate:y.currentDateValue,parseDateString:y.convertToDateValue,parseDateObject:y.convertToDateString},children:n.jsxs("div",{className:"t-date-picker__drop-holder__item__wrapper",onClick:W,children:[s==="date"&&n.jsx(q,{}),s==="month"&&n.jsx(I,{}),s==="year"&&n.jsx(E,{})]})}),children:n.jsx(C,{medium:!0,onClick:A,color:w.tGrayColor3,children:"calendar_month"})})})})});F.defaultProps={value:"",valueType:"date",separator:"-"};F.displayName="TDatePicker";try{F.displayName="TDatePicker",F.__docgenInfo={description:"",displayName:"TDatePicker",props:{value:{defaultValue:{value:""},description:"",name:"value",required:!1,type:{name:"string"}},valueType:{defaultValue:{value:"date"},description:"",name:"valueType",required:!1,type:{name:"enum",value:[{value:'"date"'},{value:'"month"'},{value:'"year"'}]}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},openFrom:{defaultValue:null,description:"",name:"openFrom",required:!1,type:{name:"string"}},openTo:{defaultValue:null,description:"",name:"openTo",required:!1,type:{name:"string"}},separator:{defaultValue:{value:"-"},description:"",name:"separator",required:!1,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"(value: string | boolean, positiveValue?: string | boolean) => void"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}},id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}},lazy:{defaultValue:null,description:"",name:"lazy",required:!1,type:{name:"boolean"}},rules:{defaultValue:null,description:"",name:"rules",required:!1,type:{name:"((value: any) => string | true)[]"}},successMessage:{defaultValue:null,description:"",name:"successMessage",required:!1,type:{name:"string"}}}}}catch{}export{F as T};
